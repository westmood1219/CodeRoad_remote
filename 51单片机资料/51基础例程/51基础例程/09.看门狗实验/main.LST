C51 COMPILER V9.52.0.0   MAIN                                                              04/11/2022 09:27:38 PAGE 1   


C51 COMPILER V9.52.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: f:\Keil\C51\BIN\C51.EXE main.c BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          /*********************************************************************************************************
   2          * 模块名称: Main.c
   3          * 摘    要: 主文件，包含初始化函数和main函数
   4          * 当前版本: 1.0.0
   5          * 作    者: Leyutek(COPYRIGHT 2018 - 2021 Leyutek. All rights reserved.)
   6          * 完成日期: 2022年2月1日
   7          * 内    容: 
   8          * 注    意: 
   9          **********************************************************************************************************
  10          * 取代版本: 
  11          * 作    者: 
  12          * 完成日期: 
  13          * 修改内容: 
  14          * 修改文件: 
  15          *********************************************************************************************************/
  16          /*********************************************************************************************************
  17          *                                              包含头文件
  18          *********************************************************************************************************/
  19          #include <reg52.h>
  20          
  21          /*********************************************************************************************************
  22          *                                              位定义
  23          *********************************************************************************************************/
  24          sbit Beep = P1 ^ 0;
  25          
  26          /*********************************************************************************************************
  27          *                                              特殊功能寄存器定义
  28          *********************************************************************************************************/
  29          sfr WDT_CONTR = 0xE1;  //定义看门狗寄存器
  30          
  31          /*********************************************************************************************************
  32          *                                              枚举结构体定义
  33          *********************************************************************************************************/
  34          
  35          /*********************************************************************************************************
  36          *                                              内部变量
  37          *********************************************************************************************************/
  38          
  39          /*********************************************************************************************************
  40          *                                              内部函数声明
  41          *********************************************************************************************************/
  42          static void DelayNms(int nms);
  43          static void InitInterrupt(void);
  44          
  45          /*********************************************************************************************************
  46          *                                              内部函数实现
  47          *********************************************************************************************************/
  48          
  49          /*********************************************************************************************************
  50          * 函数名称: DelayNms
  51          * 函数功能: 软件延迟函数，用于延迟一段时间
  52          * 输入参数: xms-延迟时间（毫秒）
  53          * 输出参数: void
  54          * 返 回 值: void
  55          * 创建日期: 2022年2月1日
C51 COMPILER V9.52.0.0   MAIN                                                              04/11/2022 09:27:38 PAGE 2   

  56          * 注    意: 
  57          *********************************************************************************************************/
  58          static void DelayNms(int nms)
  59          {
  60   1        unsigned int i,j;
  61   1        for(i = 0; i < nms; i++)
  62   1        {
  63   2          for(j = 0; j < 123; j++)
  64   2          {
  65   3            
  66   3          }
  67   2        }
  68   1      }
  69          
  70          /*********************************************************************************************************
  71          * 函数名称: InitInterrupt
  72          * 函数功能: 配置中断
  73          * 输入参数: void
  74          * 输出参数: void
  75          * 返 回 值: void
  76          * 创建日期: 2022年2月1日
  77          * 注    意: 
  78          *********************************************************************************************************/
  79          static void InitInterrupt()
  80          {
  81   1        IT0 = 1;   //设置 外部中断0 触发方式为下降沿触发
  82   1        EX0 = 1;   //打开 定时器0 中断允许
  83   1        EA  = 1;   //打开 总中断允许
  84   1      }
  85          
  86          /*********************************************************************************************************
  87          * 函数名称: main
  88          * 函数功能: 主函数
  89          * 输入参数: void
  90          * 输出参数: void
  91          * 返 回 值: void
  92          * 创建日期: 2022年2月1日
  93          * 注    意: 
  94          *********************************************************************************************************/
  95          void main()
  96          {
  97   1        unsigned char i;        //定义循环计数变量i
  98   1        unsigned char temp;     //定义临时变量temp  
  99   1        Beep = 0;
 100   1        DelayNms(100);
 101   1        Beep = 1;
 102   1      
 103   1        InitInterrupt();        //初始化中断
 104   1        WDT_CONTR = 0x33;       //设置 看门狗溢出时间为524.2ms
 105   1        while (1)
 106   1        {
 107   2          //流水灯
 108   2          temp = ~0xEF;         //将临时变量设置为打开LED1
 109   2          for(i = 0; i < 4; i++)
 110   2          {
 111   3            P2 = ~temp;         //将临时变量的值取反，并赋值给P2
 112   3            DelayNms(500);      //延迟500ms
 113   3            temp = temp << 1;   //左移一位       
 114   3            WDT_CONTR |= 0x10;  //喂狗操作       
 115   3          }
 116   2        }
 117   1      }
C51 COMPILER V9.52.0.0   MAIN                                                              04/11/2022 09:27:38 PAGE 3   

 118          
 119          /*********************************************************************************************************
 120          * 函数名称: External0_Handler
 121          * 函数功能: 外部中断0中断服务函数
 122          * 输入参数: void
 123          * 输出参数: void
 124          * 返 回 值: void
 125          * 创建日期: 2022年2月1日
 126          * 注    意: 
 127          *********************************************************************************************************/
 128          void External0_Handler() interrupt 0 
 129          {
 130   1        DelayNms(2000);  //模拟单片机因外部干扰而卡机
 131   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    131    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
